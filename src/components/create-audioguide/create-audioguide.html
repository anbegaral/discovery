<form [formGroup]="createAudioguideForm">
  <p>Please select the country and location of your audioguide. If the location is not in the list, create it.
    <locations-dropdown *ngIf="!showInputs" (idLocationEvent)="getLocation($event)" (creatingEvent)="openInput($event)"  (creatingLocationEvent)="creatingLocationEvent($event)" [creating]="true"></locations-dropdown>
    <div *ngIf="showInputs">
        <ion-item>
            <ion-label floating>Country</ion-label>
            <ion-input formControlName="country" type="text" [(ngModel)]="country"></ion-input>
        </ion-item>
        <ion-item *ngIf="!createAudioguideForm.controls.country.valid  && (createAudioguideForm.controls.country.dirty)">
            <p>Please enter a valid country.</p>
        </ion-item>
        
        <ion-item>
            <ion-label floating>Location</ion-label>
            <ion-input formControlName="location" type="text" [(ngModel)]="location"></ion-input>
        </ion-item>
        <ion-item *ngIf="!createAudioguideForm.controls.location.valid  && (createAudioguideForm.controls.location.dirty)">
            <p>Please enter a valid location.</p>
        </ion-item>
        <ion-input formControlName="idlocation" type="hidden" [(ngModel)]="idlocation"></ion-input>
    </div>
    <div *ngIf="showLocationInput">
        <ion-item>
            <ion-label floating>Location</ion-label>
            <ion-input formControlName="location" type="text" [(ngModel)]="location"></ion-input>
        </ion-item>
        <ion-item *ngIf="!createAudioguideForm.controls.location.valid  && (createAudioguideForm.controls.location.dirty)">
            <p>Please enter a valid location.</p>
        </ion-item>
        <ion-input formControlName="idlocation" type="hidden" [(ngModel)]="idlocation"></ion-input>
    </div>
    <ion-item>
        <ion-label floating>Title</ion-label>
        <ion-input formControlName="title" type="text" [(ngModel)]="title"></ion-input>
    </ion-item>
    <ion-item *ngIf="!createAudioguideForm.controls.title.valid  && (createAudioguideForm.controls.title.dirty)">
        <p>Please enter a valid title.</p>
    </ion-item>
  
    <ion-item>
        <ion-label floating>Description</ion-label>
        <ion-textarea formControlName="description" type="text" [(ngModel)]="description"></ion-textarea>
    </ion-item>
    <ion-item *ngIf="!createAudioguideForm.controls.description.valid  && (createAudioguideForm.controls.description.dirty)">
        <p>Please enter a valid description.</p>
    </ion-item>
    
    <ion-item>
        <ion-label floating>Price</ion-label>
        <ion-input formControlName="price" type="number" [(ngModel)]="price"></ion-input>
    </ion-item>
    <ion-item *ngIf="!createAudioguideForm.controls.price.valid  && (createAudioguideForm.controls.price.dirty)">
        <p>Please enter a valid price.</p>
    </ion-item>
    
    <ion-item>
        <ion-label floating>Language</ion-label>
        <ion-input formControlName="lang" type="text" [(ngModel)]="lang"></ion-input>
    </ion-item>
    <ion-item *ngIf="!createAudioguideForm.controls.lang.valid  && (createAudioguideForm.controls.lang.dirty)">
        <p>Please enter a valid language.</p>
    </ion-item>
    <div *ngIf="currentUpload">
        <div class="progress">
          <div class="progress-bar progress-bar-animated" [ngStyle]="{ 'width': currentUpload?.progress + '%' }"></div>
        </div>
        Progress: {{currentUpload?.name}} | {{currentUpload?.progress}}% Complete
    </div>
    <ion-item>
        <ion-label>
            <input formControlName="image" type="file" (change)="detectFile($event)">
        </ion-label>
    </ion-item>
    <ion-item *ngIf="!createAudioguideForm.controls.image.valid  && (createAudioguideForm.controls.image.dirty)">
        <p>Please enter a valid image.</p>
    </ion-item>
</form>
<button ion-button color="primary" full [disabled]="!createAudioguideForm.valid" (click)="createAudioguide()">Create audioguide</button>